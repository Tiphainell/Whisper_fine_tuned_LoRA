Running via sbatch on puck6 on Fri Nov 28 03:32:10 PM CET 2025
Python 3.10.13
==============================================
      Training with LoRA rank = 1
==============================================
/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
wandb: Appending key for api.wandb.ai to your netrc file: /home/tleludec/.netrc
wandb: Currently logged in as: tiphaine-leludec (tiphaine-leludec-ens) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run ymujen72
wandb: Tracking run with wandb version 0.22.2
wandb: Run data is saved locally in /home/tleludec/Transcription_whisper/Code/fine-tuning-whisper/Script/Bash/wandb/run-20251128_153217-ymujen72
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run colorful-microwave-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tiphaine-leludec-ens/fine-tuning-whisper-lora
wandb: üöÄ View run at https://wandb.ai/tiphaine-leludec-ens/fine-tuning-whisper-lora/runs/ymujen72
Traceback (most recent call last):
  File "/home/tleludec/Transcription_whisper/Code/fine-tuning-whisper/Script//src/Training.py", line 123, in <module>
    train(config=cfg)
  File "/home/tleludec/Transcription_whisper/Code/fine-tuning-whisper/Script//src/Training.py", line 30, in train
    model = prepare_lora_for_training(config, processor)
  File "/home/tleludec/Transcription_whisper/Code/fine-tuning-whisper/Script/src/utils/models.py", line 39, in prepare_lora_for_training
    model = get_peft_model(model, lora_config)
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/mapping_func.py", line 115, in get_peft_model
    return PeftModel(
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/peft_model.py", line 130, in __init__
    self.base_model = cls(model, {adapter_name: peft_config}, adapter_name)
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 209, in __init__
    self.inject_adapter(self.model, adapter_name, low_cpu_mem_usage=low_cpu_mem_usage, state_dict=state_dict)
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 654, in inject_adapter
    raise ValueError(error_msg)
ValueError: Target modules q_proj,v_proj not found in the base model. Please check the target modules and try again.
Traceback (most recent call last):
  File "/home/tleludec/Transcription_whisper/Code/fine-tuning-whisper/Script//src/Training.py", line 123, in <module>
    train(config=cfg)
  File "/home/tleludec/Transcription_whisper/Code/fine-tuning-whisper/Script//src/Training.py", line 30, in train
    model = prepare_lora_for_training(config, processor)
  File "/home/tleludec/Transcription_whisper/Code/fine-tuning-whisper/Script/src/utils/models.py", line 39, in prepare_lora_for_training
    model = get_peft_model(model, lora_config)
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/mapping_func.py", line 115, in get_peft_model
    return PeftModel(
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/peft_model.py", line 130, in __init__
    self.base_model = cls(model, {adapter_name: peft_config}, adapter_name)
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 209, in __init__
    self.inject_adapter(self.model, adapter_name, low_cpu_mem_usage=low_cpu_mem_usage, state_dict=state_dict)
  File "/home/tleludec/Transcription_whisper/venv_oberon/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 654, in inject_adapter
    raise ValueError(error_msg)
ValueError: Target modules q_proj,v_proj not found in the base model. Please check the target modules and try again.
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mcolorful-microwave-15[0m at: [34m[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20251128_153217-ymujen72/logs[0m
